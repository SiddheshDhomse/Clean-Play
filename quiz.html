<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="module.css">
    <link rel="stylesheet" href="quiz.css">
    <title>Quiz</title>
</head>
<body>
    <div class="main-content" style="margin-top: 90px;">
        <div class="left-section" style="margin-left: 150px;">
            <div class="above-image white-card">
                <b>Let's have a small quiz...</b>
            </div>
            <div class="image-section">
                <img src="images/1725474365901-removebg-preview.png" alt="Character Image" style="max-width: 80%; margin-top: 20px;">
            </div>
        </div>

        <div class="right-section">
            <div class="question-card">
                <p>What is clean sport?</p>
            </div>
            <div class="options-grid">
                <button class="option" data-option="A">A) Sport that permits any substance for better performance.</button>
                <button class="option" data-option="B">B) Sport that bans prohibited substances, ensuring fairness and integrity.</button>
                <button class="option" data-option="C">C) Sport exclusive to amateur athletes.</button>
                <button class="option" data-option="D">D) Sport centered only on fitness without rules.</button>
            </div>
            <button class="continue-button" id="continueButton" disabled><b>CHECK</b></button>
        </div>
    </div>

    <script>
        const correctAnswer = 'B'; // Correct answer is option B
        let selectedOption = null; // Store selected option
        let hasAnswered = false; // Track if user has selected an option

        // Function to handle option selection
        function selectOption(option) {
            if (hasAnswered) return; // Prevent further selection if already answered

            selectedOption = option;
            const options = document.querySelectorAll('.option');
            options.forEach(opt => opt.style.border = "none"); // Reset borders
            option.style.border = "3px solid blue"; // Highlight selected option

            const continueButton = document.getElementById('continueButton');
            continueButton.disabled = false; // Enable the "Check" button
        }

        // Event listener for all options
        document.querySelectorAll('.option').forEach(option => {
            option.addEventListener('click', () => selectOption(option));
        });

        // Function to handle Check/Continue button click
        document.getElementById('continueButton').addEventListener('click', () => {
            if (!selectedOption) return; // Do nothing if no option is selected

            const options = document.querySelectorAll('.option');

            if (!hasAnswered) { // If the user hasn't answered yet, check the answer
                if (selectedOption.getAttribute('data-option') === correctAnswer) {
                    selectedOption.style.border = "3px solid green"; // Correct answer turns green
                } else {
                    selectedOption.style.border = "3px solid red"; // Wrong answer turns red
                    const correctOption = document.querySelector(`[data-option="${correctAnswer}"]`);
                    correctOption.style.border = "3px solid green"; // Highlight correct answer in green
                    correctOption.disabled = false; // Keep the correct answer enabled
                }

                // Disable all options after checking the answer, but keep the correct answer enabled
                options.forEach(opt => {
                    if (opt.getAttribute('data-option') !== correctAnswer) {
                        opt.disabled = true;
                    }
                });

                // Change the "Check" button to "Continue" while keeping the same styling
                const continueButton = document.getElementById('continueButton');
                continueButton.innerHTML = '<b>CONTINUE</b>';
                hasAnswered = true; // Mark that the question has been answered
            } else {
                window.location.href = "index.html"; // Redirect to index.html on continue click
            }
        });

        // Voice control part (if needed)
        function enableVoiceControl() {
            readQuestionAndOptions();

            const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.lang = 'en-US';

            recognition.onresult = function(event) {
                const command = event.results[0][0].transcript.toLowerCase();
                handleVoiceCommand(command);
            };

            recognition.onend = () => {
                recognition.start(); // Restart listening after a command
            };

            recognition.start();
        }

        function handleVoiceCommand(command) {
            if (hasAnswered) {
                // If the user has already answered, only listen for "continue"
                if (command.includes("continue")) {
                    const continueButton = document.getElementById('continueButton');
                    if (!continueButton.disabled) {
                        window.location.href = "index.html"; // Navigate to the next page
                    }
                }
                return; // Stop further processing if the user has answered
            }

            const options = document.querySelectorAll('.option');
            let selectedOption = null;

            // Match command to the options (A, B, C, D)
            options.forEach(option => {
                if (command.includes(option.getAttribute('data-option').toLowerCase())) {
                    selectedOption = option;
                }
            });

            if (selectedOption) {
                selectOption(selectedOption);
                hasAnswered = true; // Mark that the user has answered
            }
        }

        // Enable voice control on page load if the mode is voice
        const urlParams = new URLSearchParams(window.location.search);
        const mode = urlParams.get('mode');
        if (mode === 'voice') {
            enableVoiceControl();
        }
    </script>
</body>
</html>
